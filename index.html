<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OptiWeight-PC Decision Aid Tool</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="script.js" defer></script>
</head>
<body>
    <div class="container">
        <h1>OptiWeight-PC Decision Aid Tool</h1>
        <nav class="tab-nav">
            <button class="tab-btn active" data-tab="introduction">Introduction</button>
            <button class="tab-btn" data-tab="attributes">Attributes & Levels</button>
            <button class="tab-btn" data-tab="inputs">Inputs</button>
            <button class="tab-btn" data-tab="uptake">Predicted Uptake</button>
            <button class="tab-btn" data-tab="cost-benefit">Cost-Benefit Analysis</button>
            <button class="tab-btn" data-tab="scenarios">Saved Scenarios</button>
        </nav>
        
        <div id="introduction" class="tab-content active">
            <h2>Introduction</h2>
            <p>This tool helps patients, clinicians, and policymakers evaluate weight loss strategies for obese individuals (BMI 27-35 kg/m²) with prostate cancer before robotic-assisted radical prostatectomy. It uses patient preferences from studies to predict program uptake and assesses cost-effectiveness to reduce risks like incontinence.</p>
            <p><strong>Educational Note:</strong> Weight loss can lower surgery complications (e.g., 20% less incontinence risk). Semaglutide (Wegovy) achieves ~5.54 kg/m² BMI reduction over 12 months but may cause nausea. Lifestyle changes (diet/exercise via NHS app) are safer but slower. Use tabs to input data, view predictions, and compare costs/benefits.</p>
        </div>
        
        <div id="attributes" class="tab-content">
            <h2>Attributes & Levels</h2>
            <p><strong>Note:</strong> These are key features of weight loss programs based on clinical research. Each has specific options (levels) to tailor your choice.</p>
            <div class="attribute-list">
                <div class="attribute-item">
                    <strong>BMI</strong>: Starting Body Mass Index<br>
                    <strong>Levels</strong>: 27-35 kg/m²<br>
                    <strong>Description</strong>: Measures obesity; higher BMI increases risks like incontinence and complications. Tool ensures trial eligibility.
                </div>
                <div class="attribute-item">
                    <strong>Cost per Month (£)</strong>: Monthly expense<br>
                    <strong>Levels</strong>: £0-300<br>
                    <strong>Description</strong>: Covers drug (e.g., Semaglutide £73 starter to £175 maintenance per NHS/BNF) or lifestyle program fees.
                </div>
                <div class="attribute-item">
                    <strong>Efficacy (BMI Reduction)</strong>: Expected BMI drop<br>
                    <strong>Levels</strong>: 0-10 kg/m²<br>
                    <strong>Description</strong>: From STEP-1 trial; 5.54 kg/m² with Semaglutide reduces incontinence risk by ~20%.
                </div>
                <div class="attribute-item">
                    <strong>Side Effects</strong>: Severity<br>
                    <strong>Levels</strong>: None (lifestyle), Mild (nausea), Moderate (GI issues)<br>
                    <strong>Description</strong>: Injections may cause side effects; lifestyle programs typically have none.
                </div>
                <div class="attribute-item">
                    <strong>Frequency</strong>: Administration schedule<br>
                    <strong>Levels</strong>: Weekly (injections), Monthly (check-ins)<br>
                    <strong>Description</strong>: Weekly for Semaglutide; monthly for lifestyle monitoring via NHS app.
                </div>
                <div class="attribute-item">
                    <strong>Method</strong>: Delivery approach<br>
                    <strong>Levels</strong>: Injection (Semaglutide), Lifestyle (diet/exercise)<br>
                    <strong>Description</strong>: Injection is medical; lifestyle uses NHS Weight Loss Plan app.
                </div>
                <div class="attribute-item">
                    <strong>Duration (months)</strong>: Program length<br>
                    <strong>Levels</strong>: 6, 12<br>
                    <strong>Description</strong>: Covers pre/post-surgery; 12 months may improve continence recovery.
                </div>
                <div class="attribute-item">
                    <strong>Programme Type</strong>: Program structure<br>
                    <strong>Levels</strong>: Combined (drug + lifestyle), Lifestyle Alone<br>
                    <strong>Description</strong>: Combined is more effective but costlier; lifestyle alone is safer and cheaper.
                </div>
            </div>
        </div>
        
        <div id="inputs" class="tab-content">
            <h2>Inputs</h2>
            <p><strong>Note:</strong> Adjust sliders or select options to customize your program. Recommendations update instantly.</p>
            <form id="inputForm">
                <div class="input-box">
                    <label>BMI (27-35 kg/m²):</label>
                    <input type="range" id="bmi" min="27" max="35" value="30" step="0.1" required>
                    <span id="bmiValue">30</span>
                </div>
                <div class="input-box">
                    <label>Cost per Month (£):</label>
                    <input type="range" id="cost" min="0" max="300" value="175" step="1" required>
                    <span id="costValue">175</span>
                </div>
                <div class="input-box">
                    <label>Efficacy (BMI Reduction):</label>
                    <input type="range" id="efficacy" min="0" max="10" value="5.54" step="0.1" required>
                    <span id="efficacyValue">5.54</span>
                </div>
                <div class="input-box">
                    <label>Side Effects:</label>
                    <div class="radio-group">
                        <label><input type="radio" name="side_effects" value="0" checked> None</label>
                        <label><input type="radio" name="side_effects" value="1"> Mild</label>
                        <label><input type="radio" name="side_effects" value="2"> Moderate</label>
                    </div>
                </div>
                <div class="input-box">
                    <label>Frequency:</label>
                    <div class="radio-group">
                        <label><input type="radio" name="frequency" value="weekly" checked> Weekly</label>
                        <label><input type="radio" name="frequency" value="monthly"> Monthly</label>
                    </div>
                </div>
                <div class="input-box">
                    <label>Method:</label>
                    <div class="radio-group">
                        <label><input type="radio" name="method" value="injection" checked> Injection</label>
                        <label><input type="radio" name="method" value="lifestyle"> Lifestyle</label>
                    </div>
                </div>
                <div class="input-box">
                    <label>Duration (months):</label>
                    <div class="radio-group">
                        <label><input type="radio" name="duration" value="6"> 6</label>
                        <label><input type="radio" name="duration" value="12" checked> 12</label>
                    </div>
                </div>
                <div class="input-box">
                    <label>Programme Type:</label>
                    <div class="radio-group">
                        <label><input type="radio" name="programme" value="combined" checked> Combined</label>
                        <label><input type="radio" name="programme" value="lifestyle"> Lifestyle Alone</label>
                    </div>
                </div>
            </form>
            <div class="button-group">
                <button id="calculateBtn">Calculate</button>
                <button id="simulateBtn">Simulate Uncertainty</button>
            </div>
            <div id="recommendations" class="recommendations"></div>
        </div>
        
        <div id="uptake" class="tab-content">
            <h2>Predicted Uptake</h2>
            <p><strong>Note:</strong> Shows the percentage of patients likely to choose this program based on preferences from research studies. Higher uptake means more patients will follow through.</p>
            <div id="uptakeResults"></div>
            <canvas id="uptakeChart" width="400" height="200"></canvas>
        </div>
        
        <div id="cost-benefit" class="tab-content">
            <h2>Cost-Benefit Analysis</h2>
            <p><strong>Note:</strong> Compares costs (drugs, monitoring, admin) to benefits (savings from fewer complications, quality-of-life gains). Benefits are scaled by uptake: e.g., 70% uptake means 70% of potential savings/QALYs. Costs use NHS pricing (e.g., Semaglutide £175/month); benefits use £460 savings per 5 kg/m² BMI reduction (from reduced complications like incontinence) and QALYs valued at £20,000 each.</p>
            <div id="cbaResults"></div>
            <canvas id="cbaChart" width="400" height="200"></canvas>
            <canvas id="simChart" width="400" height="200"></canvas>
        </div>
        
        <div id="scenarios" class="tab-content">
            <h2>Saved Scenarios</h2>
            <p><strong>Note:</strong> Save and compare multiple scenarios to find the best program for you or your patients.</p>
            <ul id="scenarioList"></ul>
            <div class="button-group">
                <button id="saveScenarioBtn">Save Current Scenario</button>
                <button id="generatePDFBtn">Generate PDF Report</button>
            </div>
        </div>
    </div>
</body>
</html>
