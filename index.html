<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OptiWeight-PC Decision Aid Tool</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/3.0.1/jspdf.umd.min.js"></script>
    <script src="script.js" defer></script>
</head>
<body>
    <div class="container">
        <h1>OptiWeight-PC Decision Aid Tool</h1>
        <div class="tab-buttons">
            <button class="tab-btn active" data-tab="introduction">Introduction</button>
            <button class="tab-btn" data-tab="attributes">Attributes & Levels</button>
            <button class="tab-btn" data-tab="inputs">Inputs</button>
            <button class="tab-btn" data-tab="uptake">Predicted Uptake</button>
            <button class="tab-btn" data-tab="cost-benefit">Cost-Benefit Analysis</button>
            <button class="tab-btn" data-tab="scenarios">Saved Scenarios</button>
        </div>
        
        <div id="introduction" class="tab-content active">
            <p>This tool is designed for patients, clinicians, and policymakers to explore weight loss options for obese individuals (BMI 27-35 kg/m²) with prostate cancer before robotic surgery. It uses patient preferences from studies to predict how likely people are to choose a program and calculates if it's worth the cost.</p>
            <p>Educational Note: Weight loss can reduce surgery risks like incontinence. Semaglutide (e.g., Wegovy) is a weekly injection that helps lose ~5-6 kg/m² BMI over 12 months, but has side effects like nausea. Lifestyle changes (diet/exercise) are safer but slower. Navigate tabs to input details, see predictions, and compare costs/benefits.</p>
        </div>
        
        <div id="attributes" class="tab-content">
            <h2>Attributes & Levels</h2>
            <p>Educational Note: These are key features of weight loss programs based on research. Each has options (levels) to customize.</p>
            <ul>
                <li><strong>BMI</strong>: Your starting Body Mass Index. Levels: 27-35 kg/m². (Description: Measures obesity; higher BMI increases surgery risks. Tool ensures eligibility.)</li>
                <li><strong>Cost per Month (£)</strong>: Monthly expense. Levels: £0-300. (Description: Includes drug or program fees; e.g., Semaglutide ~£73 starter to £175 maintenance per UK NHS/private pricing.)</li>
                <li><strong>Efficacy (BMI Reduction)</strong>: Expected BMI drop. Levels: 0-10 kg/m². (Description: From trials like STEP-1; e.g., 5.54 kg/m² with Semaglutide, reducing incontinence by ~20%.)</li>
                <li><strong>Side Effects</strong>: Severity. Levels: None (lifestyle only), Mild (nausea), Moderate (GI issues). (Description: Common with injections; none for diet/exercise.)</li>
                <li><strong>Frequency</strong>: How often. Levels: Weekly (injections), Monthly (check-ins). (Description: Weekly for Semaglutide; monthly for lifestyle monitoring.)</li>
                <li><strong>Method</strong>: Delivery. Levels: Injection (Semaglutide), Lifestyle (diet/exercise). (Description: Injection is medical; lifestyle uses apps like NHS Weight Loss Plan.)</li>
                <li><strong>Duration (months)</strong>: Length. Levels: 6 (short-term), 12 (full peri-op). (Description: Covers pre/post-surgery; longer may improve continence.)</li>
                <li><strong>Programme Type</strong>: Type. Levels: Combined (drug + lifestyle), Lifestyle Alone. (Description: Combined is more effective but costlier; alone is safer.)</li>
            </ul>
        </div>
        
        <div id="inputs" class="tab-content">
            <form id="inputForm">
                <label>BMI (27-35):</label>
                <input type="range" id="bmi" min="27" max="35" value="30" step="0.1" required> <span id="bmiValue">30</span>
                
                <label>Cost per Month (£):</label>
                <input type="range" id="cost" min="0" max="300" value="175" step="1" required> <span id="costValue">175</span>
                
                <label>Efficacy (BMI Reduction):</label>
                <input type="range" id="efficacy" min="0" max="10" value="5.54" step="0.1" required> <span id="efficacyValue">5.54</span>
                
                <label>Side Effects:</label>
                <div class="radio-group">
                    <input type="radio" id="side_none" name="side_effects" value="0" checked><label for="side_none">None</label>
                    <input type="radio" id="side_mild" name="side_effects" value="1"><label for="side_mild">Mild</label>
                    <input type="radio" id="side_mod" name="side_effects" value="2"><label for="side_mod">Moderate</label>
                </div>
                
                <label>Frequency:</label>
                <div class="radio-group">
                    <input type="radio" id="freq_weekly" name="frequency" value="weekly" checked><label for="freq_weekly">Weekly</label>
                    <input type="radio" id="freq_monthly" name="frequency" value="monthly"><label for="freq_monthly">Monthly</label>
                </div>
                
                <label>Method:</label>
                <div class="radio-group">
                    <input type="radio" id="method_inj" name="method" value="injection" checked><label for="method_inj">Injection</label>
                    <input type="radio" id="method_life" name="method" value="lifestyle"><label for="method_life">Lifestyle</label>
                </div>
                
                <label>Duration (months):</label>
                <div class="radio-group">
                    <input type="radio" id="dur_6" name="duration" value="6"><label for="dur_6">6</label>
                    <input type="radio" id="dur_12" name="duration" value="12" checked><label for="dur_12">12</label>
                </div>
                
                <label>Programme Type:</label>
                <div class="radio-group">
                    <input type="radio" id="prog_comb" name="programme" value="combined" checked><label for="prog_comb">Combined</label>
                    <input type="radio" id="prog_life" name="programme" value="lifestyle"><label for="prog_life">Lifestyle Alone</label>
                </div>
            </form>
            <button onclick="calculate()">Calculate</button>
            <button onclick="simulate()">Simulate Uncertainty</button>
            <div id="recommendations" class="recommendations"></div>
        </div>
        
        <div id="uptake" class="tab-content">
            <h2>Predicted Uptake</h2>
            <p>Note: Shows % of patients likely to choose this based on preferences from studies.</p>
            <div id="uptakeResults"></div>
            <canvas id="uptakeChart" width="400" height="200"></canvas>
        </div>
        
        <div id="cost-benefit" class="tab-content">
            <h2>Cost-Benefit Analysis</h2>
            <p>Note: Compares costs (drug, monitoring) to benefits (savings from fewer complications, QALYs). Uptake scales benefits: e.g., 70% uptake means 70% of max benefit realized.</p>
            <div id="cbaResults"></div>
            <canvas id="cbaChart" width="400" height="200"></canvas>
            <canvas id="simChart" width="400" height="200"></canvas>
        </div>
        
        <div id="scenarios" class="tab-content">
            <h2>Saved Scenarios</h2>
            <ul id="scenarioList"></ul>
            <button onclick="saveScenario()">Save Current Scenario</button>
            <button onclick="generatePDF()">Generate PDF Report</button>
        </div>
    </div>
</body>
</html>
